/* ===================== 1) CSS VARIABLES ===================== */
/* Global design tokens: colors, radii, spacing, shadows */
:root{
  --bg:#0b0f14; --text:#121316; --muted:#4a4f57;
  --panel:#fff; --line:#e7e9ee;
  --accent-red:#e0312f; --accent-gold:#d9a441; --accent-black:#16171b;
  --shadow:0 8px 24px rgba(0,0,0,.12);
  --radius:16px; --radius-sm:10px; --gap:24px;
}
*{ box-sizing:border-box; }

/* ===================== 2) BASE LAYOUT (sticky footer) ===================== */
html, body { height:100%; }
body{
  margin:0; background:#f7f8fb; color:var(--text);
  font:16px/1.75 Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  min-height:100vh; display:flex; flex-direction:column;
}
.container{ max-width:1200px; margin:0 auto; padding:24px; }
main.container{ flex:1 0 auto; }
footer.flag{ flex:0 0 auto; margin-top:var(--gap); }

/* ===================== 3) NAVBAR ===================== */
header.navbar{ background:var(--bg); color:#fff; }
.navbar .container{ display:flex; align-items:center; gap:28px; position:relative; }
.navbar a{ color:#dfe3ea; text-decoration:none; padding:18px 12px; display:inline-block; }
.navbar a[aria-current="page"]{ color:#fff; }

/* Sliding underline under hovered/active link */
.nav-underline{
  position:absolute; left:0; bottom:8px; height:3px; width:0;
  background:var(--accent-red); border-radius:2px;
  transform:translateX(0);
  transition:
    transform 320ms cubic-bezier(.25,.8,.25,1),
    width     320ms cubic-bezier(.25,.8,.25,1),
    opacity   200ms ease;
  opacity:1;
}

/* Focus-visible outlines for accessibility */
.navbar a:focus{ outline:none; }
.navbar a:focus-visible{ outline:3px solid var(--accent-gold); outline-offset:2px; }

/* Default placement of avatar; will be re-ordered in ticker section */
.nav-avatar{ margin-left:auto; }

/* ===================== 4) HEADINGS / UTILITIES ===================== */
h1{ font-size:44px; line-height:1.1; margin:28px 0 18px; font-weight:800; letter-spacing:-.5px; }
h2{ font-size:24px; margin:0 0 8px; }
h3{ font-size:18px; margin:0 0 10px; }
.sr-only{ position:absolute; left:-9999px; } /* screen-reader-only helper */

/* ===================== 5) GENERIC CARD + GRID ===================== */
.grid{ display:grid; grid-template-columns:1.2fr 1fr; gap:var(--gap); }
.card{
  background:var(--panel); border:1px solid var(--line);
  border-radius:var(--radius); box-shadow:var(--shadow); padding:22px;
}
.grid > .card, .grid > article.card, .grid > aside.card { align-self:start; }

/* ===================== 6) ISP GRID / LOGOS ===================== */
.isp-grid{ display:grid; grid-template-columns:repeat(2,1fr); gap:16px; }
.isp-card{
  display:flex; gap:12px; background:#fff; border:1px solid var(--line);
  border-radius:var(--radius-sm); padding:14px;
}
.isp-name{ margin:0 0 6px; font-weight:700; }
.isp-speed,.isp-price{ margin:0; color:var(--muted); font-size:14px; }

/* Circular logo badge (with brand-specific scaling tweaks) */
.isp-logo{
  --logo-size:44px; position:relative; width:var(--logo-size); height:var(--logo-size);
  border-radius:999px; background:#fff; border:1px solid var(--line);
  display:grid; place-items:center; overflow:hidden;
}
.isp-logo img{ width:100%; height:100%; object-fit:contain; object-position:center; display:block; transform:scale(.92); }
.isp-logo.logo-vodafone img{ transform:scale(.88); }
.isp-logo.logo-orange   img{ transform:scale(.85); }
.isp-logo.logo-we       img{ transform:scale(1.00) translateY(1px); }
.isp-logo.logo-etisalat img{ transform:scale(.95)  translateY(1px); }

/* ===================== 7) FOOTER FLAG ===================== */
.flag .stripe{ height:10px; }
.flag .stripe.red{   background:#e0312f; }
.flag .stripe.white{ background:#fff; }
.flag .stripe.black{ background:#000; }

/* Global focus style + subtle card hover lift */
a:focus,button:focus,[tabindex]:focus{ outline:3px solid var(--accent-gold); outline-offset:2px; }
.card:hover{ transform:translateY(-1px); box-shadow:0 10px 28px rgba(0,0,0,.14); }

/* ===================== 8) CHART SIZING (shared) ===================== */
.chart-box{ position:relative; width:100%; height:300px; }
#usersChart{ width:100% !important; height:100% !important; display:block; }
@media (max-width:960px){ .chart-box{ height:260px; } }

/* ===================== 9) EGYPTIAN THEME (always on) ===================== */
body.theme-egypt{
  --accent-red:#ce1126; --accent-gold:#c9a227; --panel:#fffdf7; --line:#efe7cf;
  background:
    linear-gradient(180deg, rgba(201,162,39,.04), rgba(201,162,39,.02)),
    repeating-linear-gradient(90deg, rgba(0,0,0,.015) 0 2px, transparent 2px 6px),
    #f7f1e3;
  font-family:"Cairo", Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
}
body.theme-egypt header.navbar{
  background:linear-gradient(180deg,#0a0e13,#0b0f14 60%, #0b0f14);
  box-shadow:inset 0 -1px 0 rgba(201,162,39,.18);
}
body.theme-egypt .nav-underline{ background:var(--accent-red); }
body.theme-egypt .card{
  border-color:var(--line);
  box-shadow:0 10px 28px rgba(0,0,0,.12), inset 0 0 0 2px rgba(201,162,39,.06);
}
body.theme-egypt .timeline-line{ background:var(--accent-red); }
.arabic-title{
  font-family:"Cairo", system-ui, sans-serif; font-weight:800;
  margin:-6px 0 14px 0; color:#1f1f1f;
}
body.theme-egypt footer.flag{ border-top:2px solid rgba(201,162,39,.35); }

/* ===================== 10) GROWTH PAGE LAYOUT ===================== */
.two-col{
  display:grid; grid-template-columns:1fr 1fr; gap:var(--gap);
  margin-top:var(--gap);
}
/* KPI cards / facts */
.stats-grid{ display:grid; grid-template-columns:repeat(4,1fr); gap:16px; }
@media (max-width:960px){ .stats-grid{ grid-template-columns:repeat(2,1fr); } }
.stat-card{ border:1px solid var(--line); border-radius:12px; padding:16px; background:#fff; display:flex; flex-direction:column; gap:4px; }
.stat-value{ font-size:36px; line-height:1; font-weight:800; color:#101113; }
.stat-label{ font-weight:700; color:#2b2e33; }
.stat-caption{ margin:0; color:var(--muted); font-size:14px; }

.facts-grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:16px; }
@media (max-width:960px){ .facts-grid{ grid-template-columns:1fr; } }
.fact-card{ display:flex; gap:12px; align-items:flex-start; border:1px solid var(--line); border-radius:12px; padding:14px; background:#fff; }
.fact-dot{ width:10px; height:10px; border-radius:50%; background:var(--accent-red); margin-top:7px; }
.fact-title{ margin:0 0 6px; font-size:16px; font-weight:800; }
.fact-text{ margin:0; color:var(--muted); font-size:14px; }

/* Small chart variant + responsive collapse */
.chart-box.small{ height:260px; }
@media (max-width:960px){
  .two-col{ grid-template-columns:1fr; }
  .chart-box.small{ height:240px; }
}

/* Consistent section spacing on Growth page */
body[data-page="growth"] main.container > .card,
body[data-page="growth"] main.container > .two-col { margin-top:var(--gap); }
body[data-page="growth"] main.container > :first-child{ margin-top:0; }
body[data-page="growth"] .two-col{ margin-top:0; }
body[data-page="growth"] .two-col .card{ margin:0; }

/* ===================== 11) HOME PAGE ===================== */
.hero{
  display:flex; align-items:center; justify-content:space-between;
  gap:24px; padding:28px 28px 26px;
}
.hero .lead{ margin:8px 0 16px; color:#2a2d32; font-size:18px; }
.cta-row{ display:flex; gap:12px; flex-wrap:wrap; }
.cta{ display:inline-block; padding:10px 14px; border-radius:10px; background:var(--accent-red); color:#fff; text-decoration:none; font-weight:700; }
.cta.ghost{ background:#fff; color:#101113; border:1px solid var(--line); }

.snapshots-grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:16px; }
@media (max-width:960px){ .snapshots-grid{ grid-template-columns:1fr; } }
.snapshot-card{ background:#fff; border:1px solid var(--line); border-radius:12px; padding:16px; }
.snapshot-value{ font-size:34px; line-height:1; font-weight:800; color:#101113; }
.snapshot-label{ font-weight:700; color:#2b2e33; margin-top:6px; }
.snapshot-caption{ margin:6px 0 0; color:var(--muted); font-size:14px; }

/* Horizontal mini-timeline scroller on Home */
.mini-timeline{ overflow-x:auto; }
.mini-tl{ display:flex; gap:16px; padding:4px 2px; margin:0; list-style:none; }
.mini-tl-item{
  min-width:280px; max-width:320px; border:1px solid var(--line);
  border-radius:12px; background:#fff; padding:12px;
}
.mini-tl-item .pill{
  display:inline-block; font-weight:800; font-size:14px;
  padding:.25rem .55rem; border:2px solid var(--accent-gold);
  border-radius:999px; background:#fff7df; color:#533f05; margin-bottom:6px;
}
.mini-tl-title{ display:block; font-weight:800; margin-bottom:4px; }
.mini-tl-text{ color:var(--muted); font-size:14px; }

/* Consistent section spacing on Home */
body[data-page="home"] main.container > .card,
body[data-page="home"] main.container > .hero.card{ margin-top:var(--gap); }
body[data-page="home"] main.container > :first-child{ margin-top:0; }

/* ===================== 12) TIMELINE GRID (ordered 3-up) ===================== */
.tl-grid{
  display:grid; grid-template-columns:repeat(3,1fr); gap:var(--gap);
}
@media (max-width:1200px){ .tl-grid{ grid-template-columns:repeat(2,1fr); } }
@media (max-width:760px){  .tl-grid{ grid-template-columns:1fr; } }

.tl-grid .ms-card{
  display:block; border:1px solid var(--line); background:#fff;
  border-radius:12px; padding:14px; box-shadow:var(--shadow);
  transition:transform .15s ease, box-shadow .15s ease;
}
.tl-grid .ms-card:hover{ transform:translateY(-2px); box-shadow:0 12px 30px rgba(0,0,0,.14); }
.tl-grid .pill{
  display:inline-block; font-weight:800; font-size:14px;
  padding:.25rem .55rem; border:2px solid var(--accent-gold);
  border-radius:999px; background:#fff7df; color:#533f05; margin-bottom:8px;
}
.tl-grid .ms-title{ margin:0 0 6px; font-weight:800; font-size:18px; }
.tl-grid .ms-text{ margin:0; color:var(--muted); line-height:1.6; }

@media (max-width:960px){ .grid{ grid-template-columns:1fr; } }

/* ===================== 13) ARTICLE (Today page) ===================== */
.article{ padding:26px 26px 22px; }
.article-head .dek{ margin:8px 0 0; color:#2a2d32; font-size:18px; }

.at-a-glance{
  margin:18px 0 22px; border:1px solid var(--line); background:#fff;
  border-radius:12px; padding:14px 16px;
}
.at-a-glance h3{ margin:0 0 8px; font-size:16px; font-weight:800; }
.at-a-glance ul{ margin:0; padding-left:18px; }

.article section{ margin-top:18px; }
.article .bullets{ padding-left:18px; }
.article .note{ color:var(--muted); }

.sources .note{ color:var(--muted); margin:0 0 8px; }
.sources-list{ margin:0; padding-left:18px; }
.sources-list li + li{ margin-top:8px; }

/* Consistent section spacing on Today */
body[data-page="today"] main.container > .card{ margin-top:var(--gap); }
body[data-page="today"] main.container > :first-child{ margin-top:0; }

/* ===================== 14) NAVBAR QUICK-FACTS TICKER ===================== */
/* Rotating fact “ticker”. We also swap layout so links stay left,
   ticker sits on the right, and the avatar is last. */
.navbar .nav-ticker{
  order:2;                 /* after the link anchors (default order:0) */
  margin-left:auto;        /* push ticker block to the far right */
  flex:0 1 clamp(260px, 28vw, 400px);  /* make it start later & shrink if needed */
  min-height:24px;
  display:flex; align-items:center; justify-content:flex-end; /* text to the right */
  padding-right:8px;       /* small breathing room from right edge */
  color:#aeb6c2; font-size:14px; line-height:1; white-space:nowrap;
  overflow:hidden; text-overflow:ellipsis; opacity:.9;
}
/* Avatar should be the last item and keep a small gap from ticker */
.navbar .nav-avatar{ order:3; margin-left:10px; }

/* Animate each new fact entering */
.nav-ticker span{ display:inline-block; animation:tickerIn .45s ease both; }
@keyframes tickerIn{
  from{ transform:translateY(6px); opacity:0; }
  to{   transform:translateY(0);  opacity:1; }
}

/* Hide ticker on small screens to keep header clean */
@media (max-width:900px){ .nav-ticker{ display:none; } }

/* Slightly tighter navbar spacing on narrower desktops */
@media (max-width:1100px){ .navbar .container{ gap:20px; } }

/* ===================== 15) OPTIONAL SUBHEAD BAR UNDER NAV ===================== */
.subhead{ border-bottom:1px solid rgba(0,0,0,.06); }
.subhead .container{ max-width:1200px; margin:0 auto; padding:8px 24px; }

.subhead .kicker{ margin:0; font-size:14px; line-height:1.6; color:var(--muted); }

/* =========================
   MOBILE LAYOUT FIXES
   ========================= */

/* General: avoid tiny sideways scroll caused by 100vw + padding, iOS zoom, etc */
html, body {
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  -webkit-text-size-adjust: 100%;
}

/* Container should never cause overflow; width is bounded by page padding */
.container {
  width: 100%;
  box-sizing: border-box;
}

/* 1) Make the top navbar background truly full-width on phones */
header.navbar {
  background: #111; /* matches your dark nav theme */
  width: 100%;
}
header.navbar .container {
  display: flex;
  align-items: center;
  gap: .75rem;
  padding: .75rem 1rem;
  margin: 0 auto;
  width: 100%;
  box-sizing: border-box;
  overflow-x: auto;                 /* if nav items overflow, allow horizontal scroll inside nav only */
  -webkit-overflow-scrolling: touch;
}
header.navbar a,
header.navbar .brand {
  white-space: nowrap;              /* prevent ugly mid-word wraps */
}

/* 2) Ticker and any animated underline should not force overflow */
.nav-ticker {
  min-width: 0;
  flex: 1 1 auto;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 3) Make grids stack on small screens so cards don’t squash */
@media (max-width: 640px) {
  .snapshots-grid,
  .isp-grid,
  .facts-grid,
  .mini-tl {
    display: grid;
    grid-template-columns: 1fr !important;
    gap: 0.75rem !important;
  }

  .two-col {
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 1rem !important;
  }

  .card {
    margin: .75rem 0;
    padding: 1rem;
  }

  .hero .lead {
    font-size: 1rem;
  }

  h1, .page-title {
    font-size: 1.5rem;
    line-height: 1.2;
    margin-top: .25rem;
  }
}

/* 4) Chart canvases: ensure responsive scaling and no overflow */
.chart-box,
.chart-box.small,
.chart-wrap {
  width: 100%;
  max-width: 100%;
}
canvas {
  display: block;
  max-width: 100%;
  height: auto !important; /* let Chart.js scale down */
}

/* 5) Safety for any absolutely-positioned nav underline components */
@media (max-width: 640px) {
  .navbar .active-underline,
  .nav-underline {
    left: 0 !important;
    right: 0 !important;
    max-width: 100% !important;
  }
}

/* 6) Utility: visually-hidden (for sr-only headings you've used) */
.sr-only {
  position: absolute !important;
  width: 1px; height: 1px;
  padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0 0 0 0);
  white-space: nowrap; border: 0;
}
